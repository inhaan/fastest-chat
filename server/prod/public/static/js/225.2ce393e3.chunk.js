"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[225],{7654:function(e,t,n){n(2791);t.Z=n.p+"static/media/chat.70046fe1a2ac3456d42dfc650b4ffa12.svg"},2152:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(2791),o=function(){(0,r.useLayoutEffect)((function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))}),[])}},7272:function(e,t,n){n.r(t),n.d(t,{default:function(){return p}});var r=n(9439),o=n(2791),a=n(7689),s=n(2152),c=n(6355),i=n(184),l=(0,o.memo)((function(e){var t=e.goChatRoom,n=(0,o.useState)(""),a=(0,r.Z)(n,2),s=a[0],l=a[1],u=(0,o.useCallback)((function(e){var t=e.target.value;t.includes(" ")&&(t=t.replace(" ","")),l(t)}),[]),f=(0,o.useCallback)((function(e){"Enter"===e.key&&t(s)}),[s,t]),d=(0,o.useCallback)((function(){t(s)}),[s,t]);return(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row justify-center items-center font-bold gap-5",style:{paddingTop:"calc(var(--vh, 1vh) * 20)"},children:[(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 items-center",children:[(0,i.jsx)("div",{className:"text-white text-4xl",children:"fastest-chat.com/"}),(0,i.jsx)("input",{type:"text",className:"inline-block w-52 rounded-lg outline-none px-4 py-5 text-2xl shadow-xl",autoFocus:!0,autoComplete:"on",placeholder:"\ucc44\ud305\ubc29 \uc774\ub984",value:s,onChange:u,onKeyDown:f})]}),(0,i.jsx)("div",{className:"text-3xl cursor-pointer transition-all text-yellow-300 hover:text-yellow-400 active:text-yellow-500",onClick:d,children:(0,i.jsx)(c.Z1Y,{className:"inline-block"})})]})})),u=n(6575),f=n.p+"static/media/pexels-alexander-kovalev-2847648.c6fca3751f4dd770a1fd.jpg",d=n(7892),m=n.n(d),h=n(203),x=n(7654),v=(0,o.memo)((function(e){var t=e.chatRooms,n=e.onGoChatRoom,r=e.onDeleteChatRoom,a=(0,o.useCallback)((function(e){e.stopPropagation();var t=e.currentTarget.dataset.chat_room_id;t&&window.confirm("\uae30\ub85d\uc744 \uc0ad\uc81c\ud558\uc2dc\uaca0\uc2b5\ub2c8\uae4c?")&&r(t)}),[r]),s=(0,o.useCallback)((function(e){var t=e.currentTarget.dataset.chat_room_id;t&&n(t)}),[n]);return(0,i.jsx)("ul",{className:"w-4/5 max-w-md mt-32 bg-white rounded-lg shadow-lg overflow-hidden",children:t.map((function(e){return(0,i.jsxs)("li",{"data-chat_room_id":e.roomId,className:"flex items-center gap-2 cursor-pointer px-3 py-2 sm:px-7 sm:py-5 border-b hover:bg-gray-100 active:bg-gray-200 transition-all ",onClick:s,children:[(0,i.jsx)("img",{src:x.Z,alt:"chat",className:"w-7 h-7 mr-2"}),(0,i.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,i.jsxs)("div",{className:"w-full flex justify-between",children:[(0,i.jsx)("div",{className:"break-all",children:e.roomId}),(0,i.jsxs)("div",{className:"flex items-center gap-5",children:[(0,i.jsx)("div",{className:" text-sm text-gray-400",children:m()(e.latestMessage.timestamp).format("YY.MM.DD")}),(0,i.jsx)("button",{"data-chat_room_id":e.roomId,className:"flex transition-all text-gray-500 hover:text-rose-400 active:text-rose-500",onClick:a,children:(0,i.jsx)(h._0w,{className:"inline-block"})})]})]}),(0,i.jsx)("div",{className:"text-gray-400",children:e.latestMessage.content})]})]},e.roomId)}))})})),p=(0,o.memo)((function(){(0,s.Z)();var e=(0,a.s0)(),t=(0,o.useState)([]),n=(0,r.Z)(t,2),c=n[0],d=n[1],m=(0,o.useCallback)((function(t){t?e("/".concat(t)):alert("\ucc44\ud305\ubc29 \uc774\ub984\uc744 \uc785\ub825\ud574\uc8fc\uc138\uc694.")}),[e]),h=(0,o.useCallback)((function(e){u.U.deleteChatRoom(e).then((function(){u.U.getAllChatRooms().then((function(e){d(e)}))}))}),[]);return(0,o.useLayoutEffect)((function(){u.U.getAllChatRooms().then((function(e){d(e)}))}),[]),(0,i.jsx)("div",{className:"h-screen",style:{backgroundImage:"url(".concat(f,")"),height:"calc(var(--vh, 1vh) * 100)"},children:(0,i.jsxs)("main",{children:[(0,i.jsx)("section",{children:(0,i.jsx)(l,{goChatRoom:m})}),(0,i.jsx)("section",{className:"flex justify-center",children:(0,i.jsx)(v,{chatRooms:c,onGoChatRoom:m,onDeleteChatRoom:h})})]})})}))},6575:function(e,t,n){n.d(t,{U:function(){return d}});var r=n(4165),o=n(5861),a=n(763),s=n.n(a),c=function(){return new Promise((function(e,t){var n=window.indexedDB.open("ChatDB",1);n.onerror=function(e){console.error("IndexedDB\uc5d0 \uc811\uadfc\ud558\ub294 \ub3d9\uc548 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),t("\uc624\ub958")},n.onsuccess=function(t){var n=t.target.result;e(n)},n.onupgradeneeded=function(e){e.target.result.createObjectStore("Chats",{keyPath:"roomId"}).createIndex("roomId","roomId",{unique:!0})}}))},i=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t,n){var o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:return o=e.sent,e.abrupt("return",new Promise((function(e,r){var a=o.transaction("Chats","readwrite").objectStore("Chats"),s=a.get(t);s.onsuccess=function(o){var s=o.target.result;(s=s||{roomId:t,messages:[]}).messages=n;var c=a.put(s);c.onerror=function(e){console.error("\uba54\uc2dc\uc9c0\ub97c \uc800\uc7a5\ud558\ub294 \ub3d9\uc548 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),r("\uc624\ub958")},c.onsuccess=function(t){e()}},s.onerror=function(e){console.error("\ucc44\ud305\ubc29 \ub370\uc774\ud130\ub97c \uac00\uc838\uc624\ub294 \ub3d9\uc548 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),r("\uc624\ub958")}})));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),l=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:return t=e.sent,e.abrupt("return",new Promise((function(e,n){var r=t.transaction("Chats","readonly").objectStore("Chats").getAll();r.onsuccess=function(t){var n=t.target.result.map((function(e){var t=s().sortBy(e.messages,"timestamp").pop();return{roomId:e.roomId,latestMessage:t}})).filter((function(e){return e.latestMessage}));e(n)},r.onerror=function(e){console.error("\uc804\uccb4 \ucc44\ud305\ubc29 \ub370\uc774\ud130\ub97c \uac00\uc838\uc624\ub294 \ub3d9\uc548 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),n("\uc624\ub958")}})));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),u=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,r){var o=n.transaction("Chats","readonly").objectStore("Chats").get(t);o.onsuccess=function(t){var n=t.target.result,r=n?n.messages:[];e(r)},o.onerror=function(e){console.error("\ucc44\ud305\ubc29 \ub370\uc774\ud130\ub97c \uac00\uc838\uc624\ub294 \ub3d9\uc548 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),r("\uc624\ub958")}})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=(0,o.Z)((0,r.Z)().mark((function e(t){var n;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c();case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,r){var o=n.transaction("Chats","readwrite").objectStore("Chats").delete(t);o.onsuccess=function(t){e()},o.onerror=function(e){console.error("\ucc44\ud305\ubc29\uc744 \uc0ad\uc81c\ud558\ub294 \ub3d9\uc548 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."),r("\uc624\ub958")}})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),d={saveMessages:i,getAllChatRooms:l,getMessagesByRoomId:u,deleteChatRoom:f}}}]);
//# sourceMappingURL=225.2ce393e3.chunk.js.map